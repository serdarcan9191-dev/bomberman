@startuml Backend_Component_Diagram

package "Client" {
    [Socket.io Client]
}

package "Backend Server" {
    component Server as "Socket.io Server" {
        [Event Handlers]
    }
    
    component RoomHandlers as "Room Handlers" {
        [handle_create_room]
        [handle_join_room]
        [handle_leave_room]
        [handle_list_rooms]
    }
    
    component GameHandlers as "Game Handlers" {
        [handle_player_move]
        [handle_place_bomb]
        [handle_player_ready]
    }
    
    component Services as "Services" {
        [GameSetupService]
        [GameMovementService]
        [GameStateService]
        [GameQueryService]
        [GameStartService]
        [GameUpdateService]
    }
    
    component Repository as "Repository" {
        [RoomRepository]
    }
    
    database PostgreSQL {
        [rooms table]
        [room_players table]
    }
}

[Socket.io Client] --> Server : WebSocket Connection
Server --> RoomHandlers : routes room events
Server --> GameHandlers : routes game events
RoomHandlers --> Repository : data access
GameHandlers --> Repository : data access
GameHandlers --> Services : business logic
Repository --> PostgreSQL : SQL queries

note right of Repository
    **Repository Pattern**
    Veri erişim katmanı
    İş mantığından bağımsız
end note

note right of Services
    **Service Layer**
    İş mantığı
    SOLID - Single Responsibility
end note

@enduml

